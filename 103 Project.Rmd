---
title: "Project - Submission1"
author: "Rob Ross-Shannon"
date: "2024-07-25"
output: pdf_document
---

```{r}
#Reading in data sets
library(dplyr)
setwd("/Users/Rob Ross-Shannon/Documents/GitHub/103_Project")
genes <- read.csv("~/Documents/GitHub/103_Project/QBS103_GSE157103_genes.csv")
series_matrix <- read.csv("~/Documents/GitHub/103_Project/QBS103_GSE157103_series_matrix.csv")

#Selecting gene of interest and transposing data to link with covariates
rownames(genes) <- genes$X
genes <- select(genes, -c('X'))
genesT <- as.data.frame(t(genes))
genesT$participant_id <- rownames(genesT)
genesT$participant_id[which(genesT$participant_id=="COVID_06_.y_male_NonICU")] <- "COVID_06_:y_male_NonICU"
#Selecting covariates of interest
covariates <- series_matrix[, c("participant_id","sex", "icu_status", "ferritin.ng.ml.")]
head(covariates)
head(genesT)
gene_of_interest <- select(genesT, c("AAAS", "participant_id"))
head(gene_of_interest)
#linking gene and covariate data set
combinedData <- inner_join(gene_of_interest, covariates, by = "participant_id")
combinedData

#Removing any unknown values from ferritin.ng.ml dataset
ferritin.ng.mlData <- combinedData[combinedData$ferritin.ng.ml. != " unknown",]
ferritin.ng.mlData

```
```{r}
hist(combinedData$AAAS, breaks = 30, col = "indianred")

```

```{r}
ggplot(ferritin.ng.mlData,aes(x = AAAS,y = ferritin.ng.ml.)) +
  geom_point()+
```

```{r}
ggplot(combinedData,aes(x = sex,y = AAAS,color = icu_status)) +
  # Add box plot
  geom_boxplot() +
  # Change labels
  labs(x = 'Sex',y = 'Gene Frequency',color = 'ICU Status')
```

